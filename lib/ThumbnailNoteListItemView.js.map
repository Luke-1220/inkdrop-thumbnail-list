{"version":3,"file":"ThumbnailNoteListItemView.js","names":["_react","_interopRequireWildcard","require","_dayjs","_interopRequireDefault","_relativeTime","_classnames","_whiteMatter","_extractImgUrl","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","dayjs","extend","relativeTime","ThumbnailNoteListItemView","props","StreamlineIcon","inkdrop","components","getComponentClass","NoteStatusIcon","NoteListItemShareStatusView","TaskProgressView","TagList","NoteListItemSummaryView","active","focused","note","onClick","onDblClick","onContextMenu","onMiddleClick","title","status","updatedAt","share","numOfTasks","numOfCheckedTasks","tags","pinned","_conflicts","body","_rev","data","matter","showEmoji","config","emojiKey","emoji","undefined","imageUrl","extractImgUrl","replace","thumbnailKey","imageStyle","showSummary","bgColor","ThumbnailView","createElement","className","style","backgroundColor","src","classes","classNames","task","fmt","date","Date","fromNow","format","taskState","isTask","handleClick","useCallback","e","preventDefault","stopPropagation","handleMouseDown","button","handleDblClick","handleContextMenu","onDoubleClick","onMouseDown","name","color","visibility","tagIds","revId","registerAsNoteListItemView","registerClass","unregisterAsNoteListItemView","deleteClass"],"sources":["../src/ThumbnailNoteListItemView.js"],"sourcesContent":["import React, { useCallback } from 'react'\nimport dayjs from 'dayjs'\nimport relativeTime from 'dayjs/plugin/relativeTime'\nimport classNames from 'classnames'\nimport matter from 'white-matter'\nimport { extractImgUrl } from 'extract-img-url'\n\ndayjs.extend(relativeTime)\n\nexport default function ThumbnailNoteListItemView(props) {\n  const StreamlineIcon = inkdrop.components.getComponentClass('StreamlineIcon')\n  const NoteStatusIcon = inkdrop.components.getComponentClass('NoteStatusIcon')\n  const NoteListItemShareStatusView = inkdrop.components.getComponentClass(\n    'NoteListItemShareStatusView'\n  )\n  const TaskProgressView =\n    inkdrop.components.getComponentClass('TaskProgressView')\n  const TagList = inkdrop.components.getComponentClass('TagList')\n  const NoteListItemSummaryView = inkdrop.components.getComponentClass(\n    'NoteListItemSummaryView'\n  )\n\n  const {\n    active,\n    focused,\n    note,\n    onClick,\n    onDblClick,\n    onContextMenu,\n    onMiddleClick\n  } = props\n  const {\n    title,\n    status,\n    updatedAt,\n    share,\n    numOfTasks,\n    numOfCheckedTasks,\n    tags,\n    pinned,\n    _conflicts,\n    body,\n    _rev\n  } = note\n\n  const { data } = matter(body)\n\n  const showEmoji = inkdrop.config.get('thumbnail-list.showEmoji')\n  const emojiKey = inkdrop.config.get('thumbnail-list.emojiKeyName') ?? 'emoji'\n  const emoji = showEmoji ? data?.[emojiKey] : undefined\n\n  let imageUrl = extractImgUrl(body)?.replace(\n    /^inkdrop:\\/\\/file:/,\n    'inkdrop-file://file:'\n  )\n\n  const thumbnailKey =\n    inkdrop.config.get('thumbnail-list.keyName') ?? 'thumbnail'\n  if (data?.[thumbnailKey] !== undefined) {\n    imageUrl = data[thumbnailKey]\n  }\n\n  const imageStyle = inkdrop.config.get('thumbnail-list.imageStyle')\n  const showSummary = inkdrop.config.get('thumbnail-list.showSummary')\n  const bgColor = inkdrop.config.get('thumbnail-list.bgColor')\n\n  const ThumbnailView = () => {\n    if (imageUrl) {\n      return (\n        <div className=\"thumbnail\">\n          <div className=\"wrapper\" style={{ backgroundColor: bgColor }}>\n            <img className={`image ${imageStyle}`} src={imageUrl} />\n          </div>\n        </div>\n      )\n    }\n  }\n\n  const classes = classNames({\n    'thumbnail-note-list-item-view': true,\n    'note-list-item-view': true,\n    active,\n    focused,\n    task: status !== 'none',\n    'has-thumbnail': !!imageUrl\n  })\n  const fmt = dayjs(updatedAt)\n  const date =\n    updatedAt >= +new Date() - 1000 * 60 * 60 * 24 * 37\n      ? fmt.fromNow(true)\n      : fmt.format('YYYY-MM-DD')\n  const taskState = status ? `task-${status}` : ''\n  const isTask = typeof numOfTasks === 'number' && numOfTasks > 0\n\n  const handleClick = useCallback(\n    e => {\n      onClick && onClick(e, note)\n      e.preventDefault()\n      e.stopPropagation()\n    },\n    [onClick, note]\n  )\n\n  const handleMouseDown = useCallback(\n    e => {\n      if (e.button === 1) {\n        onMiddleClick && onMiddleClick(e, note)\n        e.preventDefault()\n        e.stopPropagation()\n      }\n    },\n    [onMiddleClick, note]\n  )\n\n  const handleDblClick = useCallback(\n    e => {\n      onDblClick && onDblClick(e, note)\n      e.preventDefault()\n      e.stopPropagation()\n    },\n    [onDblClick, note]\n  )\n\n  const handleContextMenu = useCallback(\n    e => {\n      onContextMenu && onContextMenu(e, note)\n      e.preventDefault()\n    },\n    [onContextMenu, note]\n  )\n\n  return (\n    <div\n      className={`${classes} ${taskState}`}\n      onClick={handleClick}\n      onContextMenu={handleContextMenu}\n      onDoubleClick={handleDblClick}\n      onMouseDown={handleMouseDown}\n    >\n      <div className=\"content\">\n        <div className=\"header\">\n          {_conflicts && (\n            <StreamlineIcon name=\"warning-bold\" className=\"inline\" />\n          )}\n          {pinned && (\n            <StreamlineIcon\n              name=\"pin-bold\"\n              className=\"inline\"\n              color=\"var(--primary-color)\"\n            />\n          )}\n          <NoteStatusIcon status={status} />\n          <NoteListItemShareStatusView visibility={share} />\n          {(emoji ? `${emoji} ` : '') + (title || 'Untitled')}\n        </div>\n        <div className=\"description\">\n          <div className=\"meta\">\n            <span className=\"date\">{date}</span>\n            {isTask && (\n              <TaskProgressView\n                numOfTasks={numOfTasks || 0}\n                numOfCheckedTasks={numOfCheckedTasks || 0}\n              />\n            )}\n            <TagList tagIds={tags} />\n          </div>\n          {showSummary && (\n            <NoteListItemSummaryView revId={_rev || ''} body={body} />\n          )}\n        </div>\n      </div>\n      {ThumbnailView()}\n    </div>\n  )\n}\n\nexport function registerAsNoteListItemView() {\n  inkdrop.components.registerClass(\n    ThumbnailNoteListItemView,\n    'CustomNoteListItemView'\n  )\n}\n\nexport function unregisterAsNoteListItemView() {\n  inkdrop.components.deleteClass(\n    ThumbnailNoteListItemView.default,\n    'CustomNoteListItemView'\n  )\n}\n"],"mappings":"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"}